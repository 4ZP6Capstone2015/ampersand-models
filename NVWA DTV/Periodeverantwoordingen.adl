CONTEXT DTV IN DUTCH LATEX
INCLUDE "Tijdvakken.adl"
--INCLUDE "Tijdregistratie.adl"
INCLUDE "Dagverantwoordingen.adl"
INCLUDE "Berichten.adl"

PATTERN Periodeverantwoordingen
PURPOSE PATTERN Periodeverantwoordingen
{+Uren van een medewerker worden periodiek geaccordeerd door een leidinggevende.
Een pakket van tijdverantwoordingen van één medewerker, dat in één keer geaccordeerd is door diens leidinggevende, noemen we een periodeverantwoording.
-}
CLASSIFY Periodeverantwoording ISA Bericht

CONCEPT Periodeverantwoording "Een periodeverantwoording is een pakket van alle tijdverantwoordingen van één medewerker uit één verantwoordingsperiode."
PURPOSE CONCEPT Periodeverantwoording 
{+DTV verwerkt geregistreerde en geaccordeerde uren per medewerker per verantwoordingsperiode.
Elke verantwoordingsperiode duurt 28 dagen, wat overeenkomt met de werkperiode, die de WTR 2012 heeft vastgesteld voor medewerkers voor wie
de tijdstippen van aanvang en einde van de werktijd volgens een tevoren vastgesteld rooster wisselen (o.g.v. BBRA Artikel 23).
Het totaal van een periodeverantwoording bevat de te verwerken uren van één bepaalde persoon voor een bepaalde verantwoordingsperiode.
In een periodeverantwoording zitten dan ook alle tijdverantwoordingen uit de gegeven verantwoordingsperiode. 
Dit resulteert in één periodeverantwoording per medewerker, die geaccordeerde tijdverantwoordingen bevat.
Het woord ``timesheet'' wordt hiervoor als synoniem gebruikt. Dit woord is afkomstig uit de informatie-analyse.

Het personeelsnummer uit P-Direkt wordt gebruikt om medewerkers te identificeren.
In SPIN komen ook nog badge-nummers voor, maar die worden in de DTV-applicatie niet gebruikt.
Dat personeelsnummer staat in de relatie afkomstigVan, en is daarmee de afzender van het bericht waarin de periodeverantwoording binnenkomt.
-}

RELATION periodeverantwoording[Dagverantwoording*Periodeverantwoording] [UNI,TOT]
MEANING "Van elke dagverantwoording staat eenduidig vast tot welke periodeverantwoording hij behoort."
PURPOSE RELATION periodeverantwoording[Dagverantwoording*Periodeverantwoording]
{+Omdat medewerkers hun uren per dag verantwoorden, maar per verantwoordingsperiode laten goedkeuren,
houdt het systeem bij welke dagverantwoordingen tot welke periodeverantwoording behoren.
Een periodeverantwoording van een persoon bestaat uit dagverantwoordingen,
die voorafgaand aan het sluiten van de verantwoordingsperiode door de leidinggevende zijn goedgekeurd (in SPIN).
Van elke dagverantwoording houdt de DTV-applicatie bij tot welke periodeverantwoording hij behoort.
-}

--VIEW Periodeverantwoording : Periodeverantwoording (TXT "dagperiode ",verantwoordingsperiode, TXT " van ", periodeverantwoording~;medewerkerPerD)

-- RELATION periodeverantwoordingToelageVoorafgaande36Kalendermaanden[Periodeverantwoording*Bedrag] [UNI]
-- MEANING "Een persoon kan in de 36 maanden voorafgaand aan de maand waarin hij 55 jaar is geworden een gemiddeld bedrag aan toelagen hebben ontvangen."
-- PURPOSE RELATION periodeverantwoordingToelageVoorafgaande36Kalendermaanden[Periodeverantwoording*Bedrag] REF "BBRA Artikel 17 lid 4"
-- {+Bij het berekenen van de toelage voor ongebruikelijke tijden is het bedrag dat de ambtenaar, over de zesendertig kalendermaanden voorafgaande aan de maand 
-- waarin hij de leeftijd van 55 jaar bereikt, gemiddeld per maand aan toelage heeft ontvangen een relevante factor zijn. 
-- -}

-- RELATION periodeverantwoordingOngebruikelijkeUren[Periodeverantwoording*Tijdsduur] [UNI] PRAGMA "" " heeft als gevolg van ongebruikelijke werktijden als totaal aantal extra uren "
-- MEANING "Een periodeverantwoording heeft een totaal aan extra uren als gevolg van ongebruikelijke werktijden."
-- PURPOSE RELATION periodeverantwoordingOngebruikelijkeUren[Periodeverantwoording*Tijdsduur]
-- {+Het totaal aantal extra uren dat moet worden uitbetaald als gevolg van ongebruikelijke werktijden moet worden doorgegeven aan de organisatie die zorgt voor de salarisuitkering.
-- -}

RELATION verantwoordingsperiode[Periodeverantwoording*Verantwoordingsperiode] [UNI,TOT] PRAGMA "" " is een verantwoordiging voor verantwoordingsperiode "
MEANING "Voor elke periodeverantwoording registreert het systeem de verantwoordingsperiode."
PURPOSE RELATION verantwoordingsperiode[Periodeverantwoording*Verantwoordingsperiode]
{+De geregistreerde uren van een medewerker worden per verantwoordingsperiode verwerkt.
Een verantwoordingsperiode is de periode waarover de NVWA de toeslagen berekent; dat gebeurt elke vier weken.
Dit loopt niet precies in de pas met de betaalperiodes van de overheid, die per maand gaan.
-}

RULE identificeerPeriodeverantwoording : afkomstigVan;afkomstigVan~ /\ verantwoordingsperiode;verantwoordingsperiode~ |- I[Periodeverantwoording]

PURPOSE RELATION periodenaam[Verantwoordingsperiode*PNaam]
{+De NVWA duidt een verantwoordingsperiode aan met een naam,
die bestaat uit de letter p, gevolgd door het jaartal (vier cijfers) en een volgnummer (twee cijfers).
-}
RELATION periodenaam[Verantwoordingsperiode*PNaam] [UNI,TOT] PRAGMA "" " heeft als naam " ""  -- 
MEANING "Elke verantwoordingsperiode heeft een unieke naam."

PURPOSE RULE verantwoordingsperiode
{+Elke tijdverantwoording valt binnen één specifieke periodeverantwoording, afhankelijk van het begintijdstip van de betreffende tijdverantwoording..
-}
RULE verantwoordingsperiode : dag[Tijdverantwoording*Dagverantwoording];periodeverantwoording;verantwoordingsperiode = begin;binnenTijdvak
MEANING "Een tijdverantwoording behoort tot de periodeverantwoording, waarbinnen het begin-tijdstip valt."
ENDPATTERN

POPULATION afkomstigVan[Bericht*Personeelsnummer] CONTAINS
  [ ("pv11","22222222")
  ; ("pv13", "33333333")
  ; ("pv14", "33333333")
  ; ("pv15", "33333333")
  ; ("pv1201411", "11111111")
  ; ("pv2201411", "22222222")
  ; ("pv3201411", "33333333")
  ; ("pv1201412", "11111111")
  ; ("pv2201412", "22222222")
  ; ("pv3201412", "33333333")
  ; ("pv1201413", "11111111")
  ; ("pv2201413", "22222222")
  ; ("pv3201413", "33333333")
  ]

POPULATION verantwoordingsperiode[Periodeverantwoording*Verantwoordingsperiode] CONTAINS
  [ ("pv11","p201411")
  ; ("pv13","p201409")
  ; ("pv14","p201401")
  ; ("pv15","p201401")
  ; ("pv1201411", "p201411")
  ; ("pv2201411", "p201411")
  ; ("pv3201411", "p201411")
  ; ("pv1201412", "p201412")
  ; ("pv2201412", "p201412")
  ; ("pv3201412", "p201412")
  ; ("pv1201413", "p201413")
  ; ("pv2201413", "p201413")
  ; ("pv3201413", "p201413")
  ]

POPULATION periodenaam[Verantwoordingsperiode*PNaam] CONTAINS
  [ ("p201301", "p201301")
  ; ("p201302", "p201302")
  ; ("p201303", "p201303")
  ; ("p201304", "p201304")
  ; ("p201305", "p201305")
  ; ("p201306", "p201306")
  ; ("p201307", "p201307")
  ; ("p201308", "p201308")
  ; ("p201309", "p201309")
  ; ("p201310", "p201310")
  ; ("p201311", "p201311")
  ; ("p201312", "p201312")
  ; ("p201313", "p201313")
  ; ("p201401", "p201401")
  ; ("p201402", "p201402")
  ; ("p201403", "p201403")
  ; ("p201404", "p201404")
  ; ("p201405", "p201405")
  ; ("p201406", "p201406")
  ; ("p201407", "p201407")
  ; ("p201408", "p201408")
  ; ("p201409", "p201409")
  ; ("p201410", "p201410")
  ; ("p201411", "p201411")
  ; ("p201412", "p201412")
  ; ("p201413", "p201413")
  ; ("p201501", "p201501")
  ; ("p201502", "p201502")
  ; ("p201503", "p201503")
  ; ("p201504", "p201504")
  ; ("p201505", "p201505")
  ; ("p201506", "p201506")
  ; ("p201507", "p201507")
  ; ("p201508", "p201508")
  ; ("p201509", "p201509")
  ; ("p201510", "p201510")
  ; ("p201511", "p201511")
  ; ("p201512", "p201512")
  ; ("p201513", "p201513")
  ; ("p201601", "p201601")
  ; ("p201602", "p201602")
  ; ("p201603", "p201603")
  ; ("p201604", "p201604")
  ; ("p201605", "p201605")
  ; ("p201606", "p201606")
  ; ("p201607", "p201607")
  ; ("p201608", "p201608")
  ; ("p201609", "p201609")
  ; ("p201610", "p201610")
  ; ("p201611", "p201611")
  ; ("p201612", "p201612")
  ; ("p201613", "p201613")
  ; ("p201701", "p201701")
  ; ("p201702", "p201702")
  ; ("p201703", "p201703")
  ; ("p201704", "p201704")
  ; ("p201705", "p201705")
  ; ("p201706", "p201706")
  ; ("p201707", "p201707")
  ; ("p201708", "p201708")
  ; ("p201709", "p201709")
  ; ("p201710", "p201710")
  ; ("p201711", "p201711")
  ; ("p201712", "p201712")
  ; ("p201713", "p201713")
  ]

ENDCONTEXT