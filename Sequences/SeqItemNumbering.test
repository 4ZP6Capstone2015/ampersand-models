CONTEXT "SeqItemNumberingTest" IN ENGLISH

-- INCLUDE "../SIAM/SIAM_LoginStub.adl"
   INCLUDE "./SeqItemNumbering.adl"

sessionNewSeq :: SESSION * SeqName
ROLE ExecEngine MAINTAINS "Create new Sequence"
RULE "Create new Sequence": sessionNewSeq |- -V
   VIOLATION ( TXT "{EX} NewStruct;Sequence;seqName;Sequence;_NEW;SeqName;", TGT I
             , TXT "{EX} DelPair;sessionNewSeq;SESSION;", SRC I, TXT ";SeqName;", TGT I
             )

POPULATION seqName CONTAINS [ ("TestSeq", "TestSeq") ]

VIEW Sequences: Sequence(seqName)
VIEW Items: Item(itemName)

INTERFACE "Overview"
    (sessionNewSeq, seqName
    ,seqNewFirstItem, seqNewLastItem
    ,itemInsNextItem, itemInsPrevItem
    ,itemNewNextItem, itemNewPrevItem
    ,itemRmvReq, itemDelReq 
    ,seqSinFirstValue
    ) :  '_SESSION' CRUD ROWS
    [ "New Sequence" : sessionNewSeq
    , "Sequences" : V[SESSION*Sequence] COLS
       [ "Sequence name"  : seqName
       , "New first item" : seqNewFirstItem
       , "New last item"  : seqNewLastItem
       , "1st item index" : seqSinFirstValue
       ]
    , "Items" : V[SESSION*Sequence] ROWS
       [ "Seqence" : I COLS
          [ "Name" : I
          , "First item" : seqFirstItem
          , "Last item" : seqLastItem
          ]
       , "Items" : V;itemInSeq~ BOX <SHCOLS>
          [ "Prev"     : nextItem~
          , "Item"     : I 
          , "Next"     : nextItem
          , "InsNext"  : itemInsNextItem
          , "InsPrev"  : itemInsPrevItem
          , "Rmv?"     : itemRmvReq
          , "Del?"     : itemDelReq
          , "NewNext"  : itemNewNextItem
          , "NewPrev"  : itemNewPrevItem
          , "Index"    : itemSinValue
          ]
       ]
    , "Orphaned Items" : V[SESSION*Item];(I-itemInSeq;itemInSeq~) BOX <SHCOLS>
       [ "Prev"     : nextItem~
       , "Item"     : I 
       , "Next"     : nextItem
       , "InsNext"  : itemInsNextItem
       , "InsPrev"  : itemInsPrevItem
       , "Rmv?"     : itemRmvReq
       , "Del?"     : itemDelReq
       , "NewNext"  : itemNewNextItem
       , "NewPrev"  : itemNewPrevItem
       , "Index"    : itemSinValue
       ]
    ]

ENDCONTEXT